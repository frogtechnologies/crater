import{J as me,B as A,a0 as re,k as g,aR as ue,aS as ie,r as s,o as y,l as _,w as t,f as a,q as D,ag as N,u as l,m as B,i as d,t as c,j as E,V as j,h as p,x}from"./vendor.8669b7df.js";import{b as ce,j as de,e as pe,g as f}from"./main.8525167c.js";import{u as ye}from"./payment.dbc88c1c.js";import{_ as _e}from"./CapsuleIcon.0de657ce.js";import{_ as fe,a as be}from"./SendPaymentModal.f2e3b0c7.js";import"./mail-driver.12e9c4e5.js";const ve={class:"relative table-container"},Be={class:"relative flex items-center justify-end h-5"},he={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},ge={class:"absolute items-center left-6 top-2.5 select-none"},Ce={class:"relative block"},Ee={setup(ke){const{t:i}=me();let b=A(!1),C=A(!0),h=A(null);const r=re({customer:"",payment_mode:"",payment_number:""}),m=ye();ce();const U=de(),k=pe(),S=g(()=>!m.paymentTotalCount&&!C.value),Y=g(()=>[{key:"status",sortable:!1,thClass:"extra w-10",tdClass:"text-left text-sm font-medium extra"},{key:"payment_date",label:i("payments.date"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"payment_number",label:i("payments.payment_number")},{key:"name",label:i("payments.customer")},{key:"payment_mode",label:i("payments.payment_mode")},{key:"invoice_number",label:i("invoices.invoice_number")},{key:"amount",label:i("payments.amount")},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),P=g({get:()=>m.selectedPayments,set:n=>m.selectPayment(n)}),I=g({get:()=>m.selectAllField,set:n=>m.setSelectAllState(n)});ue(r,()=>{L()},{debounce:500}),ie(()=>{m.selectAllField&&m.selectAllPayments()}),m.fetchPaymentModes({limit:"all"});async function R(n){return(await m.fetchPaymentModes({search:n})).data.data}function W(){return k.hasAbilities([f.DELETE_PAYMENT,f.EDIT_PAYMENT,f.VIEW_PAYMENT,f.SEND_PAYMENT])}async function H({page:n,filter:o,sort:v}){let $={customer_id:r.customer_id,payment_method_id:r.payment_mode!==null?r.payment_mode:"",payment_number:r.payment_number,orderByField:v.fieldName||"created_at",orderBy:v.order||"desc",page:n};C.value=!0;let u=await m.fetchPayments($);return C.value=!1,{data:u.data.data,pagination:{totalPages:u.data.meta.last_page,currentPage:n,totalCount:u.data.meta.total,limit:10}}}function w(){h.value&&h.value.refresh()}function L(){w()}function F(){r.customer_id="",r.payment_mode="",r.payment_number=""}function z(){b.value&&F(),b.value=!b.value}function G(){U.openDialog({title:i("general.are_you_sure"),message:i("payments.confirm_delete",2),yesLabel:i("general.ok"),noLabel:i("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(n=>{n&&m.deleteMultiplePayments().then(o=>{o.data.success&&w()})})}return(n,o)=>{const v=s("BaseBreadcrumbItem"),$=s("BaseBreadcrumb"),u=s("BaseIcon"),V=s("BaseButton"),q=s("BasePageHeader"),J=s("BaseCustomerSelectInput"),T=s("BaseInputGroup"),O=s("BaseInput"),X=s("BaseMultiselect"),K=s("BaseFilterWrapper"),Q=s("BaseEmptyPlaceholder"),Z=s("BaseDropdownItem"),ee=s("BaseDropdown"),M=s("BaseCheckbox"),te=s("router-link"),ae=s("BaseText"),ne=s("BaseFormatMoney"),le=s("BaseTable"),se=s("BasePage");return y(),_(se,{class:"payments"},{default:t(()=>[a(fe),a(q,{title:n.$t("payments.title")},{actions:t(()=>[D(a(V,{variant:"primary-outline",onClick:z},{right:t(e=>[l(b)?(y(),_(u,{key:1,name:"XIcon",class:B(e.class)},null,8,["class"])):(y(),_(u,{key:0,class:B(e.class),name:"FilterIcon"},null,8,["class"]))]),default:t(()=>[d(c(n.$t("general.filter"))+" ",1)]),_:1},512),[[N,l(m).paymentTotalCount]]),l(k).hasAbilities(l(f).CREATE_PAYMENT)?(y(),_(V,{key:0,variant:"primary",class:"ml-4",onClick:o[0]||(o[0]=e=>n.$router.push("/admin/payments/create"))},{left:t(e=>[a(u,{name:"PlusIcon",class:B(e.class)},null,8,["class"])]),default:t(()=>[d(" "+c(n.$t("payments.add_payment")),1)]),_:1})):E("",!0)]),default:t(()=>[a($,null,{default:t(()=>[a(v,{title:n.$t("general.home"),to:"dashboard"},null,8,["title"]),a(v,{title:n.$tc("payments.payment",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),a(K,{show:l(b),class:"mt-3",onClear:F},{default:t(()=>[a(T,{label:n.$t("payments.customer")},{default:t(()=>[a(J,{modelValue:l(r).customer_id,"onUpdate:modelValue":o[1]||(o[1]=e=>l(r).customer_id=e),placeholder:n.$t("customers.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(T,{label:n.$t("payments.payment_number")},{default:t(()=>[a(O,{modelValue:l(r).payment_number,"onUpdate:modelValue":o[2]||(o[2]=e=>l(r).payment_number=e)},{left:t(e=>[a(u,{name:"HashtagIcon",class:B(e.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(T,{label:n.$t("payments.payment_mode")},{default:t(()=>[a(X,{modelValue:l(r).payment_mode,"onUpdate:modelValue":o[3]||(o[3]=e=>l(r).payment_mode=e),"value-prop":"id","track-by":"name","filter-results":!1,label:"name","resolve-on-load":"",delay:500,searchable:"",options:R},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),l(S)?(y(),_(Q,{key:0,title:n.$t("payments.no_payments"),description:n.$t("payments.list_of_payments")},j({default:t(()=>[a(_e,{class:"mt-5 mb-4"})]),_:2},[l(k).hasAbilities(l(f).CREATE_PAYMENT)?{name:"actions",fn:t(()=>[a(V,{variant:"primary-outline",onClick:o[4]||(o[4]=e=>n.$router.push("/admin/payments/create"))},{left:t(e=>[a(u,{name:"PlusIcon",class:B(e.class)},null,8,["class"])]),default:t(()=>[d(" "+c(n.$t("payments.add_new_payment")),1)]),_:1})])}:void 0]),1032,["title","description"])):E("",!0),D(p("div",ve,[p("div",Be,[l(m).selectedPayments.length?(y(),_(ee,{key:0},{activator:t(()=>[p("span",he,[d(c(n.$t("general.actions"))+" ",1),a(u,{name:"ChevronDownIcon"})])]),default:t(()=>[a(Z,{onClick:G},{default:t(()=>[a(u,{name:"TrashIcon",class:"mr-3 text-gray-600"}),d(" "+c(n.$t("general.delete")),1)]),_:1})]),_:1})):E("",!0)]),a(le,{ref_key:"tableComponent",ref:h,data:H,columns:l(Y),"placeholder-count":l(m).paymentTotalCount>=20?10:5,class:"mt-3"},j({header:t(()=>[p("div",ge,[a(M,{modelValue:l(I),"onUpdate:modelValue":o[5]||(o[5]=e=>x(I)?I.value=e:null),variant:"primary",onChange:l(m).selectAllPayments},null,8,["modelValue","onChange"])])]),"cell-status":t(({row:e})=>[p("div",Ce,[a(M,{id:e.id,modelValue:l(P),"onUpdate:modelValue":o[6]||(o[6]=oe=>x(P)?P.value=oe:null),value:e.data.id,variant:"primary"},null,8,["id","modelValue","value"])])]),"cell-payment_date":t(({row:e})=>[d(c(e.data.formatted_payment_date),1)]),"cell-payment_number":t(({row:e})=>[a(te,{to:{path:`payments/${e.data.id}/view`},class:"font-medium text-primary-500"},{default:t(()=>[d(c(e.data.payment_number),1)]),_:2},1032,["to"])]),"cell-name":t(({row:e})=>[a(ae,{text:e.data.customer.name,length:30,tag:"span"},null,8,["text"])]),"cell-payment_mode":t(({row:e})=>[p("span",null,c(e.data.payment_method?e.data.payment_method.name:"-"),1)]),"cell-invoice_number":t(({row:e})=>[p("span",null,c(e?.data?.invoice?.invoice_number?e?.data?.invoice?.invoice_number:"-"),1)]),"cell-amount":t(({row:e})=>[a(ne,{amount:e.data.amount,currency:e.data.customer.currency},null,8,["amount","currency"])]),_:2},[W()?{name:"cell-actions",fn:t(({row:e})=>[a(be,{row:e.data,table:l(h)},null,8,["row","table"])])}:void 0]),1032,["columns","placeholder-count"])],512),[[N,!l(S)]])]),_:1})}}};export{Ee as default};
