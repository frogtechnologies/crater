import{J as N,G as re,ah as Q,r as i,o as y,l as g,w as r,f as l,u as e,i as B,t as $,j as M,B as j,e as R,aY as ne,U as W,a0 as Z,k as D,aE as ue,L as q,M as A,aT as ie,T as de,h as O,x as ee,y as me,m as H,F as ce,aj as pe,V as _e}from"./vendor.8669b7df.js";import{j as fe,u as ye,m as z,e as te,c as G,g as U,o as F}from"./main.8525167c.js";const ve={props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(T){const c=T,t=fe();ye();const{t:u}=N(),f=z();re();const p=te(),d=G();Q("utils");async function m(C){await f.fetchCustomField(C),d.openModal({title:u("settings.custom_fields.edit_custom_field"),componentName:"CustomFieldModal",size:"sm",data:C,refreshData:c.loadData})}async function V(C){t.openDialog({title:u("general.are_you_sure"),message:u("settings.custom_fields.custom_field_confirm_delete"),yesLabel:u("general.ok"),noLabel:u("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async b=>{b&&(await f.deleteCustomFields(C),c.loadData&&c.loadData())})}return(C,b)=>{const _=i("BaseIcon"),I=i("BaseDropdownItem"),h=i("BaseDropdown");return y(),g(h,null,{activator:r(()=>[l(_,{name:"DotsHorizontalIcon",class:"h-5 text-gray-500"})]),default:r(()=>[e(p).hasAbilities(e(U).EDIT_CUSTOM_FIELDS)?(y(),g(I,{key:0,onClick:b[0]||(b[0]=o=>m(T.row.id))},{default:r(()=>[l(_,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),B(" "+$(C.$t("general.edit")),1)]),_:1})):M("",!0),e(p).hasAbilities(e(U).DELETE_CUSTOM_FIELDS)?(y(),g(I,{key:1,onClick:b[1]||(b[1]=o=>V(T.row.id))},{default:r(()=>[l(_,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),B(" "+$(C.$t("general.delete")),1)]),_:1})):M("",!0)]),_:1})}}},Ce={class:"flex items-center mt-1"},be={emits:["onAdd"],setup(T,{emit:c}){const t=j(null);function u(){if(t.value==null||t.value==""||t.value==null)return!0;c("onAdd",t.value),t.value=null}return(f,p)=>{const d=i("BaseInput"),m=i("BaseIcon");return y(),R("div",Ce,[l(d,{modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=V=>t.value=V),type:"text",class:"w-full md:w-96",placeholder:f.$t("settings.custom_fields.press_enter_to_add"),onClick:u,onKeydown:ne(W(u,["prevent","stop"]),["enter"])},null,8,["modelValue","placeholder","onKeydown"]),l(m,{name:"PlusCircleIcon",class:"ml-1 text-primary-500 cursor-pointer",onClick:u})])}}};function ge(T){switch(T){case"../../custom-fields/types/DateTimeType.vue":return F(()=>import("./DateTimeType.501a0408.js"),["assets/DateTimeType.501a0408.js","assets/vendor.8669b7df.js"]);case"../../custom-fields/types/DateType.vue":return F(()=>import("./DateType.13ec9120.js"),["assets/DateType.13ec9120.js","assets/vendor.8669b7df.js"]);case"../../custom-fields/types/DropdownType.vue":return F(()=>import("./DropdownType.1d8eaf93.js"),["assets/DropdownType.1d8eaf93.js","assets/vendor.8669b7df.js"]);case"../../custom-fields/types/InputType.vue":return F(()=>import("./InputType.f3afaf76.js"),["assets/InputType.f3afaf76.js","assets/vendor.8669b7df.js"]);case"../../custom-fields/types/NumberType.vue":return F(()=>import("./NumberType.eb921d76.js"),["assets/NumberType.eb921d76.js","assets/vendor.8669b7df.js"]);case"../../custom-fields/types/PhoneType.vue":return F(()=>import("./PhoneType.c40a2c97.js"),["assets/PhoneType.c40a2c97.js","assets/vendor.8669b7df.js"]);case"../../custom-fields/types/SwitchType.vue":return F(()=>import("./SwitchType.a265f699.js"),["assets/SwitchType.a265f699.js","assets/vendor.8669b7df.js"]);case"../../custom-fields/types/TextAreaType.vue":return F(()=>import("./TextAreaType.5ed486e3.js"),["assets/TextAreaType.5ed486e3.js","assets/vendor.8669b7df.js"]);case"../../custom-fields/types/TimeType.vue":return F(()=>import("./TimeType.fad74daa.js"),["assets/TimeType.fad74daa.js","assets/vendor.8669b7df.js"]);case"../../custom-fields/types/UrlType.vue":return F(()=>import("./UrlType.ecc89c2f.js"),["assets/UrlType.ecc89c2f.js","assets/vendor.8669b7df.js"]);default:return new Promise(function(c,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+T)))})}}const Fe={class:"flex justify-between w-full"},Te=["onSubmit"],we={class:"overflow-y-auto max-h-[550px]"},$e={class:"px-4 md:px-8 py-8 overflow-y-auto sm:p-6"},Ie={class:"z-0 flex justify-end p-4 border-t border-solid border-gray-light border-modal-bg"},he={setup(T){const c=G(),t=z(),{t:u}=N();let f=j(!1);const p=Z(["Customer","Invoice","Estimate","Expense","Payment"]),d=Z([{label:"Text",value:"Input"},{label:"Textarea",value:"TextArea"},{label:"Phone",value:"Phone"},{label:"URL",value:"Url"},{label:"Number",value:"Number"},{label:"Select Field",value:"Dropdown"},{label:"Switch Toggle",value:"Switch"},{label:"Date",value:"Date"},{label:"Time",value:"Time"},{label:"Date & Time",value:"DateTime"}]);let m=j(d[0]);const V=D(()=>c.active&&c.componentName==="CustomFieldModal"),C=D(()=>m.value&&m.value.label==="Switch Toggle"),b=D(()=>m.value&&m.value.label==="Select Field"),_=D(()=>t.currentCustomField.type?ue(()=>ge(`../../custom-fields/types/${t.currentCustomField.type}Type.vue`)):!1),I=D({get:()=>t.currentCustomField.is_required===1,set:s=>{const a=s?1:0;t.currentCustomField.is_required=a}}),h=D(()=>({currentCustomField:{type:{required:q.withMessage(u("validation.required"),A)},name:{required:q.withMessage(u("validation.required"),A)},label:{required:q.withMessage(u("validation.required"),A)},model_type:{required:q.withMessage(u("validation.required"),A)},order:{required:q.withMessage(u("validation.required"),A),numeric:q.withMessage(u("validation.numbers_only"),ie)},type:{required:q.withMessage(u("validation.required"),A)}}})),o=de(h,D(()=>t));function S(){t.isEdit?m.value=d.find(s=>s.value==t.currentCustomField.type):(t.currentCustomField.model_type=p[0],t.currentCustomField.type=d[0].value,m.value=d[0])}async function L(){if(o.value.currentCustomField.$touch(),o.value.currentCustomField.$invalid)return!0;f.value=!0;let s={...t.currentCustomField};if(t.currentCustomField.options&&(s.options=t.currentCustomField.options.map(E=>E.name)),s.type=="Time"&&typeof s.default_answer=="object"){let E=s&&s.default_answer&&s.default_answer.HH?s.default_answer.HH:null,k=s&&s.default_answer&&s.default_answer.mm?s.default_answer.mm:null;s&&s.default_answer&&s.default_answer.ss&&s.default_answer.ss,s.default_answer=`${E}:${k}`}await(t.isEdit?t.updateCustomField:t.addCustomField)(s),f.value=!1,c.refreshData&&c.refreshData(),x()}function P(s){t.currentCustomField.options=[{name:s},...t.currentCustomField.options]}function v(s){if(t.isEdit&&t.currentCustomField.in_use)return;t.currentCustomField.options[s].name===t.currentCustomField.default_answer&&(t.currentCustomField.default_answer=null),t.currentCustomField.options.splice(s,1)}function se(s){t.currentCustomField.type=s.value}function x(){c.closeModal(),setTimeout(()=>{t.resetCurrentCustomField(),o.value.$reset()},300)}return(s,a)=>{const E=i("BaseIcon"),k=i("BaseInput"),w=i("BaseInputGroup"),K=i("BaseMultiselect"),le=i("BaseSwitch"),oe=i("BaseInputGrid"),Y=i("BaseButton"),ae=i("BaseModal");return y(),g(ae,{show:e(V),onOpen:S},{header:r(()=>[O("div",Fe,[B($(e(c).title)+" ",1),l(E,{name:"XIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:x})])]),default:r(()=>[O("form",{action:"",onSubmit:W(L,["prevent"])},[O("div",we,[O("div",$e,[l(oe,{layout:"one-column"},{default:r(()=>[l(w,{label:s.$t("settings.custom_fields.name"),required:"",error:e(o).currentCustomField.name.$error&&e(o).currentCustomField.name.$errors[0].$message},{default:r(()=>[l(k,{ref:"name",modelValue:e(t).currentCustomField.name,"onUpdate:modelValue":a[0]||(a[0]=n=>e(t).currentCustomField.name=n),invalid:e(o).currentCustomField.name.$error,onInput:a[1]||(a[1]=n=>e(o).currentCustomField.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),l(w,{label:s.$t("settings.custom_fields.model"),error:e(o).currentCustomField.model_type.$error&&e(o).currentCustomField.model_type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?s.$t("settings.custom_fields.model_in_use"):"",required:""},{default:r(()=>[l(K,{modelValue:e(t).currentCustomField.model_type,"onUpdate:modelValue":a[2]||(a[2]=n=>e(t).currentCustomField.model_type=n),options:e(p),"can-deselect":!1,invalid:e(o).currentCustomField.model_type.$error,searchable:!0,disabled:e(t).currentCustomField.in_use,onInput:a[3]||(a[3]=n=>e(o).currentCustomField.model_type.$touch())},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),l(w,{class:"flex items-center space-x-4",label:s.$t("settings.custom_fields.required")},{default:r(()=>[l(le,{modelValue:e(I),"onUpdate:modelValue":a[4]||(a[4]=n=>ee(I)?I.value=n:null)},null,8,["modelValue"])]),_:1},8,["label"]),l(w,{label:s.$t("settings.custom_fields.type"),error:e(o).currentCustomField.type.$error&&e(o).currentCustomField.type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?s.$t("settings.custom_fields.type_in_use"):"",required:""},{default:r(()=>[l(K,{modelValue:e(m),"onUpdate:modelValue":[a[5]||(a[5]=n=>ee(m)?m.value=n:m=n),se],options:e(d),invalid:e(o).currentCustomField.type.$error,disabled:e(t).currentCustomField.in_use,searchable:!0,"can-deselect":!1,object:""},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),l(w,{label:s.$t("settings.custom_fields.label"),required:"",error:e(o).currentCustomField.label.$error&&e(o).currentCustomField.label.$errors[0].$message},{default:r(()=>[l(k,{modelValue:e(t).currentCustomField.label,"onUpdate:modelValue":a[6]||(a[6]=n=>e(t).currentCustomField.label=n),invalid:e(o).currentCustomField.label.$error,onInput:a[7]||(a[7]=n=>e(o).currentCustomField.label.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),e(b)?(y(),g(w,{key:0,label:s.$t("settings.custom_fields.options")},{default:r(()=>[l(be,{onOnAdd:P}),(y(!0),R(ce,null,me(e(t).currentCustomField.options,(n,J)=>(y(),R("div",{key:J,class:"flex items-center mt-5"},[l(k,{modelValue:n.name,"onUpdate:modelValue":X=>n.name=X,class:"w-64"},null,8,["modelValue","onUpdate:modelValue"]),l(E,{name:"MinusCircleIcon",class:H(["ml-1 cursor-pointer",e(t).currentCustomField.in_use?"text-gray-300":"text-red-300"]),onClick:X=>v(J)},null,8,["class","onClick"])]))),128))]),_:1},8,["label"])):M("",!0),l(w,{label:s.$t("settings.custom_fields.default_value"),class:"relative"},{default:r(()=>[(y(),g(pe(e(_)),{modelValue:e(t).currentCustomField.default_answer,"onUpdate:modelValue":a[8]||(a[8]=n=>e(t).currentCustomField.default_answer=n),options:e(t).currentCustomField.options,"default-date-time":e(t).currentCustomField.dateTimeValue},null,8,["modelValue","options","default-date-time"]))]),_:1},8,["label"]),e(C)?M("",!0):(y(),g(w,{key:1,label:s.$t("settings.custom_fields.placeholder")},{default:r(()=>[l(k,{modelValue:e(t).currentCustomField.placeholder,"onUpdate:modelValue":a[9]||(a[9]=n=>e(t).currentCustomField.placeholder=n)},null,8,["modelValue"])]),_:1},8,["label"])),l(w,{label:s.$t("settings.custom_fields.order"),error:e(o).currentCustomField.order.$error&&e(o).currentCustomField.order.$errors[0].$message,required:""},{default:r(()=>[l(k,{modelValue:e(t).currentCustomField.order,"onUpdate:modelValue":a[10]||(a[10]=n=>e(t).currentCustomField.order=n),type:"number",invalid:e(o).currentCustomField.order.$error,onInput:a[11]||(a[11]=n=>e(o).currentCustomField.order.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})])]),O("div",Ie,[l(Y,{class:"mr-3",type:"button",variant:"primary-outline",onClick:x},{default:r(()=>[B($(s.$t("general.cancel")),1)]),_:1}),l(Y,{variant:"primary",loading:e(f),disabled:e(f),type:"submit"},{left:r(n=>[e(f)?M("",!0):(y(),g(E,{key:0,class:H(n.class),name:"SaveIcon"},null,8,["class"]))]),default:r(()=>[B(" "+$(e(t).isEdit?s.$t("general.update"):s.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,Te)]),_:1},8,["show"])}}},Be={class:"text-xs text-gray-500"},Se={setup(T){const c=G(),t=z(),u=te(),f=Q("utils"),{t:p}=N(),d=j(null),m=D(()=>[{key:"name",label:p("settings.custom_fields.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"model_type",label:p("settings.custom_fields.model")},{key:"type",label:p("settings.custom_fields.type")},{key:"is_required",label:p("settings.custom_fields.required")},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]);async function V({page:_,filter:I,sort:h}){let o={orderByField:h.fieldName||"created_at",orderBy:h.order||"desc",page:_},S=await t.fetchCustomFields(o);return{data:S.data.data,pagination:{totalPages:S.data.meta.last_page,currentPage:_,limit:5,totalCount:S.data.meta.total}}}function C(){c.openModal({title:p("settings.custom_fields.add_custom_field"),componentName:"CustomFieldModal",size:"sm",refreshData:d.value&&d.value.refresh})}async function b(){d.value&&d.value.refresh()}return(_,I)=>{const h=i("BaseIcon"),o=i("BaseButton"),S=i("BaseBadge"),L=i("BaseTable"),P=i("BaseSettingCard");return y(),g(P,{title:_.$t("settings.menu_title.custom_fields"),description:_.$t("settings.custom_fields.section_description")},{action:r(()=>[e(u).hasAbilities(e(U).CREATE_CUSTOM_FIELDS)?(y(),g(o,{key:0,variant:"primary-outline",onClick:C},{left:r(v=>[l(h,{class:H(v.class),name:"PlusIcon"},null,8,["class"]),B(" "+$(_.$t("settings.custom_fields.add_custom_field")),1)]),_:1})):M("",!0)]),default:r(()=>[l(he),l(L,{ref_key:"table",ref:d,data:V,columns:e(m),class:"mt-16"},_e({"cell-name":r(({row:v})=>[B($(v.data.name)+" ",1),O("span",Be," ("+$(v.data.slug)+")",1)]),"cell-is_required":r(({row:v})=>[l(S,{"bg-color":e(f).getBadgeStatusColor(v.data.is_required?"YES":"NO").bgColor,color:e(f).getBadgeStatusColor(v.data.is_required?"YES":"NO").color},{default:r(()=>[B($(v.data.is_required?_.$t("settings.custom_fields.yes"):_.$t("settings.custom_fields.no").replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),_:2},[e(u).hasAbilities([e(U).DELETE_CUSTOM_FIELDS,e(U).EDIT_CUSTOM_FIELDS])?{name:"cell-actions",fn:r(({row:v})=>[l(ve,{row:v.data,table:d.value,"load-data":b},null,8,["row","table"])])}:void 0]),1032,["columns"])]),_:1},8,["title","description"])}}};export{Se as default};
