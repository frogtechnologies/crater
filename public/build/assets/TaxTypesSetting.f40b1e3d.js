import{j as R,u as H,q as Y,e as $,c as j,g as f,b as q,r as G}from"./main.8525167c.js";import{J as M,G as J,ah as V,r as o,o as p,l as g,w as e,u as t,f as n,i as T,t as B,j as N,B as z,k as P,V as O,m as K,e as Q,x as W}from"./vendor.8669b7df.js";import{_ as Z}from"./TaxTypeModal.500864b3.js";const ee={props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(b){const a=b,S=R();H();const{t:r}=M(),h=Y(),v=J(),m=$(),E=j();V("utils");async function c(d){await h.fetchTaxType(d),E.openModal({title:r("settings.tax_types.edit_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:a.loadData&&a.loadData})}function C(d){S.openDialog({title:r("general.are_you_sure"),message:r("settings.tax_types.confirm_delete"),yesLabel:r("general.ok"),noLabel:r("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async u=>{if(u){if((await h.deleteTaxType(d)).data.success)return a.loadData&&a.loadData(),!0;a.loadData&&a.loadData()}})}return(d,u)=>{const i=o("BaseIcon"),w=o("BaseButton"),D=o("BaseDropdownItem"),k=o("BaseDropdown");return p(),g(k,null,{activator:e(()=>[t(v).name==="tax-types.view"?(p(),g(w,{key:0,variant:"primary"},{default:e(()=>[n(i,{name:"DotsHorizontalIcon",class:"h-5 text-white"})]),_:1})):(p(),g(i,{key:1,name:"DotsHorizontalIcon",class:"h-5 text-gray-500"}))]),default:e(()=>[t(m).hasAbilities(t(f).EDIT_TAX_TYPE)?(p(),g(D,{key:0,onClick:u[0]||(u[0]=I=>c(b.row.id))},{default:e(()=>[n(i,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(d.$t("general.edit")),1)]),_:1})):N("",!0),t(m).hasAbilities(t(f).DELETE_TAX_TYPE)?(p(),g(D,{key:1,onClick:u[1]||(u[1]=I=>C(b.row.id))},{default:e(()=>[n(i,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(d.$t("general.delete")),1)]),_:1})):N("",!0)]),_:1})}}},te={key:0},ne={setup(b){const{t:a}=M(),S=V("utils"),r=q(),h=Y(),v=j(),m=$(),E=G(),c=z(null),C=z(r.selectedCompanySettings.tax_per_item),d=P(()=>[{key:"name",label:a("settings.tax_types.tax_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"compound_tax",label:a("settings.tax_types.compound_tax"),tdClass:"font-medium text-gray-900"},{key:"percent",label:a("settings.tax_types.percent"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),u=P(()=>r.selectedCompanySettings.sales_tax_us_enabled==="YES"&&E.salesTaxUSEnabled),i=P({get:()=>C.value==="YES",set:async l=>{const _=l?"YES":"NO";let y={settings:{tax_per_item:_}};C.value=_,await r.updateCompanySettings({data:y,message:"general.setting_updated"})}});function w(){return m.hasAbilities([f.DELETE_TAX_TYPE,f.EDIT_TAX_TYPE])}async function D({page:l,filter:_,sort:y}){let A={orderByField:y.fieldName||"created_at",orderBy:y.order||"desc",page:l},x=await h.fetchTaxTypes(A);return{data:x.data.data,pagination:{totalPages:x.data.meta.last_page,currentPage:l,totalCount:x.data.meta.total,limit:5}}}async function k(){c.value&&c.value.refresh()}function I(){v.openModal({title:a("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:c.value&&c.value.refresh})}return(l,_)=>{const y=o("BaseIcon"),A=o("BaseButton"),x=o("BaseBadge"),X=o("BaseTable"),L=o("BaseDivider"),U=o("BaseSwitchSection"),F=o("BaseSettingCard");return p(),g(F,{title:l.$t("settings.tax_types.title"),description:l.$t("settings.tax_types.description")},O({default:e(()=>[n(Z),n(X,{ref_key:"table",ref:c,class:"mt-16",data:D,columns:t(d)},O({"cell-compound_tax":e(({row:s})=>[n(x,{"bg-color":t(S).getBadgeStatusColor(s.data.compound_tax?"YES":"NO").bgColor,color:t(S).getBadgeStatusColor(s.data.compound_tax?"YES":"NO").color},{default:e(()=>[T(B(s.data.compound_tax?"Yes":"No".replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),"cell-percent":e(({row:s})=>[T(B(s.data.percent)+" % ",1)]),_:2},[w()?{name:"cell-actions",fn:e(({row:s})=>[n(ee,{row:s.data,table:c.value,"load-data":k},null,8,["row","table"])])}:void 0]),1032,["columns"]),t(m).currentUser.is_owner?(p(),Q("div",te,[n(L,{class:"mt-8 mb-2"}),n(U,{modelValue:t(i),"onUpdate:modelValue":_[0]||(_[0]=s=>W(i)?i.value=s:null),disabled:t(u),title:l.$t("settings.tax_types.tax_per_item"),description:l.$t("settings.tax_types.tax_setting_description")},null,8,["modelValue","disabled","title","description"])])):N("",!0)]),_:2},[t(m).hasAbilities(t(f).CREATE_TAX_TYPE)?{name:"action",fn:e(()=>[n(A,{type:"submit",variant:"primary-outline",onClick:I},{left:e(s=>[n(y,{class:K(s.class),name:"PlusIcon"},null,8,["class"])]),default:e(()=>[T(" "+B(l.$t("settings.tax_types.add_new_tax")),1)]),_:1})])}:void 0]),1032,["title","description"])}}};export{ne as default};
