import{q as K,c as W,e as ce,b as Q,p as ue,g as se,T as ve,k as $e,u as we,d as Se}from"./main.8525167c.js";import{D as Be,d as Ie}from"./DragIcon.37a311b6.js";import{B as F,a0 as me,ah as oe,J as R,k as S,C as ne,r as p,o as l,e as b,h as n,t as h,f as a,V as Te,u as o,w as c,i as L,l as D,j as A,G as Pe,A as X,L as O,M as Y,b2 as pe,S as te,aX as ke,T as ae,x as J,F as Z,y as ee,H as ye,a7 as Ce,W as Me,m as G,Y as De,X as Ve,Z as je,N as qe,D as xe,U as fe}from"./vendor.8669b7df.js";import{_ as Le}from"./SelectNotePopup.185af238.js";const Ee={class:"flex items-center justify-between mb-3"},Ae={class:"flex items-center text-base",style:{flex:"4"}},Oe={class:"pr-2 mb-0",align:"right"},Ue={class:"absolute left-3.5"},ze={class:"ml-2 text-sm leading-none text-primary-400 cursor-pointer"},Ne=n("br",null,null,-1),Fe={class:"text-sm text-right",style:{flex:"3"}},Ye={class:"flex items-center justify-center w-6 h-10 mx-2 cursor-pointer"},Ge={props:{ability:{type:String,default:""},store:{type:Object,default:null},storeProp:{type:String,default:""},itemIndex:{type:Number,required:!0},index:{type:Number,required:!0},taxData:{type:Object,required:!0},taxes:{type:Array,default:[]},total:{type:Number,default:0},totalTax:{type:Number,default:0},currency:{type:[Object,String],required:!0},updateItems:{type:Function,default:()=>{}}},emits:["remove","update"],setup(t,{emit:s}){const e=t,i=K(),w=W(),$=ce(),B=F(null),y=me({...e.taxData});oe("utils");const{t:P}=R(),m=S(()=>i.taxTypes.map(_=>({..._})).map(_=>(e.taxes.find(x=>x.tax_type_id===_.id)?_.disabled=!0:_.disabled=!1,_))),q=S(()=>y.compound_tax&&e.total?(e.total+e.totalTax)*y.percent/100:e.total&&y.percent?e.total*y.percent/100:0);ne(()=>e.total,()=>{I()}),ne(()=>e.totalTax,()=>{I()}),e.taxData.tax_type_id>0&&(B.value=i.taxTypes.find(u=>u.id===e.taxData.tax_type_id)),I();function j(u){y.percent=u.percent,y.tax_type_id=u.id,y.compound_tax=u.compound_tax,y.name=u.name,I()}function I(){y.tax_type_id!==0&&s("update",{index:e.index,item:{...y,amount:q.value}})}function d(){let u={itemIndex:e.itemIndex,taxIndex:e.index};w.openModal({title:P("settings.tax_types.add_tax"),componentName:"TaxTypeModal",data:u,size:"sm"})}function r(u){e.store.$patch(_=>{_[e.storeProp].items[e.itemIndex].taxes.splice(u,1)})}return(u,_)=>{const k=p("BaseIcon"),x=p("BaseMultiselect"),M=p("BaseFormatMoney");return l(),b("div",Ee,[n("div",Ae,[n("label",Oe,h(u.$t("invoices.item.tax")),1),a(x,{modelValue:B.value,"onUpdate:modelValue":[_[0]||(_[0]=T=>B.value=T),_[1]||(_[1]=T=>j(T))],"value-prop":"id",options:o(m),placeholder:u.$t("general.select_a_tax"),"open-direction":"top","track-by":"name",searchable:"",object:"",label:"name"},Te({singlelabel:c(({value:T})=>[n("div",Ue,h(T.name)+" - "+h(T.percent)+" % ",1)]),option:c(({option:T})=>[L(h(T.name)+" - "+h(T.percent)+" % ",1)]),_:2},[o($).hasAbilities(t.ability)?{name:"action",fn:c(()=>[n("button",{type:"button",class:"flex items-center justify-center w-full px-2 cursor-pointer py-2 bg-gray-200 border-none outline-none",onClick:d},[a(k,{name:"CheckCircleIcon",class:"h-5 text-primary-400"}),n("label",ze,h(u.$t("invoices.add_new_tax")),1)])])}:void 0]),1032,["modelValue","options","placeholder"]),Ne]),n("div",Fe,[a(M,{amount:o(q),currency:t.currency},null,8,["amount","currency"])]),n("div",Ye,[t.taxes.length&&t.index!==t.taxes.length-1?(l(),D(k,{key:0,name:"TrashIcon",class:"h-5 text-gray-700 cursor-pointer",onClick:_[2]||(_[2]=T=>r(t.index))})):A("",!0)])])}}},We={class:"box-border bg-white border border-gray-200 border-solid rounded-b"},Re={colspan:"5",class:"p-0 text-left align-top"},Xe={class:"w-full"},He=n("col",{style:{width:"40%","min-width":"280px"}},null,-1),Je=n("col",{style:{width:"10%","min-width":"120px"}},null,-1),Ze=n("col",{style:{width:"15%","min-width":"120px"}},null,-1),Ke={key:0,style:{width:"15%","min-width":"160px"}},Qe=n("col",{style:{width:"15%","min-width":"120px"}},null,-1),et={class:"px-5 py-4 text-left align-top"},tt={class:"flex justify-start"},st={class:"flex items-center justify-center w-5 h-5 mt-2 text-gray-300 cursor-move handle mr-2"},ot={class:"px-5 py-4 text-right align-top"},nt={class:"px-5 py-4 text-left align-top"},at={class:"flex flex-col"},rt={class:"flex-auto flex-fill bd-highlight"},lt={class:"relative w-full"},it={key:0,class:"px-5 py-4 text-left align-top"},dt={class:"flex flex-col"},ct={class:"flex",style:{width:"120px"},role:"group"},ut={class:"flex items-center"},mt={class:"px-5 py-4 text-right align-top"},pt={class:"flex items-center justify-end text-sm"},yt={class:"flex items-center justify-center w-6 h-10 mx-2"},xt={key:0},ft=n("td",{class:"px-5 py-4 text-left align-top"},null,-1),gt={colspan:"4",class:"px-5 py-4 text-left align-top"},ht={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},itemData:{type:Object,default:null},index:{type:Number,default:null},type:{type:String,default:""},loading:{type:Boolean,default:!1},currency:{type:[Object,String],required:!0},invoiceItems:{type:Array,required:!0},itemValidationScope:{type:String,default:""}},emits:["update","remove","itemValidate"],setup(t,{emit:s}){const e=t,i=Q(),w=ue();Pe();const{t:$}=R(),B=S({get:()=>e.itemData.quantity,set:f=>{E("quantity",parseFloat(f))}}),y=S({get:()=>{const f=e.itemData.price;return parseFloat(f)>0?f/100:f},set:f=>{if(parseFloat(f)>0){let C=Math.round(f*100);E("price",C)}else E("price",f)}}),P=S(()=>e.itemData.price*e.itemData.quantity),m=S({get:()=>e.itemData.discount,set:f=>{e.itemData.discount_type==="percentage"?E("discount_val",P.value*f/100):E("discount_val",Math.round(f*100)),E("discount",f)}}),q=S(()=>P.value-e.itemData.discount_val),j=S(()=>e.currency?e.currency:i.selectedCompanyCurrency),I=S(()=>e.store[e.storeProp].items.length!=1),d=S(()=>Math.round(X.exports.sumBy(e.itemData.taxes,function(f){return f.compound_tax?0:f.amount}))),r=S(()=>Math.round(X.exports.sumBy(e.itemData.taxes,function(f){return f.compound_tax?f.amount:0}))),u=S(()=>d.value+r.value),_={name:{required:O.withMessage($("validation.required"),Y)},quantity:{required:O.withMessage($("validation.required"),Y),minValue:O.withMessage($("validation.qty_must_greater_than_zero"),pe(0)),maxLength:O.withMessage($("validation.amount_maxlength"),te(20))},price:{required:O.withMessage($("validation.required"),Y),minValue:O.withMessage($("validation.number_length_minvalue"),pe(1)),maxLength:O.withMessage($("validation.price_maxlength"),te(20))},discount_val:{between:O.withMessage($("validation.discount_maxlength"),ke(0,S(()=>P.value)))},description:{maxLength:O.withMessage($("validation.notes_maxlength"),te(65e3))}},k=ae(_,S(()=>e.store[e.storeProp].items[e.index]),{$scope:e.itemValidationScope});function x(f){e.store.$patch(z=>{z[e.storeProp].items[e.index].taxes[f.index]=f.item}),e.itemData.taxes[e.itemData.taxes.length-1]?.tax_type_id!==0&&e.store.$patch(z=>{z[e.storeProp].items[e.index].taxes.push({...ve,id:ye.raw()})}),V()}function M(f){E("name",f)}function T(f){e.store.$patch(C=>{if(C[e.storeProp].items[e.index].name=f.name,C[e.storeProp].items[e.index].price=f.price,C[e.storeProp].items[e.index].item_id=f.id,C[e.storeProp].items[e.index].description=f.description,f.unit&&(C[e.storeProp].items[e.index].unit_name=f.unit.name),e.store[e.storeProp].tax_per_item==="YES"&&f.taxes){let z=0;f.taxes.forEach(H=>{x({index:z,item:{...H}}),z++})}C[e.storeProp].exchange_rate&&(C[e.storeProp].items[e.index].price/=C[e.storeProp].exchange_rate)}),w.fetchItems(),V()}function g(){e.itemData.discount_type!=="fixed"&&(E("discount_val",Math.round(e.itemData.discount*100)),E("discount_type","fixed"))}function v(){e.itemData.discount_type!=="percentage"&&(E("discount_val",P.value*e.itemData.discount/100),E("discount_type","percentage"))}function V(){let f=e.store[e.storeProp]?.items[e.index]?.taxes;f||(f=[]);let C={...e.store[e.storeProp].items[e.index],index:e.index,total:q.value,sub_total:P.value,totalSimpleTax:d.value,totalCompoundTax:r.value,totalTax:u.value,tax:u.value,taxes:[...f]};e.store.updateItem(C)}function E(f,C){e.store.$patch(z=>{z[e.storeProp].items[e.index][f]=C}),V()}return(f,C)=>{const z=p("BaseItemSelect"),H=p("BaseInput"),U=p("BaseMoney"),re=p("BaseIcon"),ge=p("BaseButton"),le=p("BaseDropdownItem"),he=p("BaseDropdown"),ie=p("BaseContentPlaceholdersText"),de=p("BaseContentPlaceholders"),_e=p("BaseFormatMoney");return l(),b("tr",We,[n("td",Re,[n("table",Xe,[n("colgroup",null,[He,Je,Ze,t.store[t.storeProp].discount_per_item==="YES"?(l(),b("col",Ke)):A("",!0),Qe]),n("tbody",null,[n("tr",null,[n("td",et,[n("div",tt,[n("div",st,[a(Be)]),a(z,{type:"Invoice",item:t.itemData,invalid:o(k).name.$error,"invalid-description":o(k).description.$error,taxes:t.itemData.taxes,index:t.index,"store-prop":t.storeProp,store:t.store,onSearch:M,onSelect:T},null,8,["item","invalid","invalid-description","taxes","index","store-prop","store"])])]),n("td",ot,[a(H,{modelValue:o(B),"onUpdate:modelValue":C[0]||(C[0]=N=>J(B)?B.value=N:null),invalid:o(k).quantity.$error,"content-loading":t.loading,type:"number",small:"",min:"0",step:"any",onChange:C[1]||(C[1]=N=>V()),onInput:C[2]||(C[2]=N=>o(k).quantity.$touch())},null,8,["modelValue","invalid","content-loading"])]),n("td",nt,[n("div",at,[n("div",rt,[n("div",lt,[(l(),D(U,{key:o(j),modelValue:o(y),"onUpdate:modelValue":C[3]||(C[3]=N=>J(y)?y.value=N:null),invalid:o(k).price.$error,"content-loading":t.loading,currency:o(j)},null,8,["modelValue","invalid","content-loading","currency"]))])])])]),t.store[t.storeProp].discount_per_item==="YES"?(l(),b("td",it,[n("div",dt,[n("div",ct,[a(H,{modelValue:o(m),"onUpdate:modelValue":C[4]||(C[4]=N=>J(m)?m.value=N:null),invalid:o(k).discount_val.$error,"content-loading":t.loading,class:"border-r-0 focus:border-r-2 rounded-tr-sm rounded-br-sm h-[38px]"},null,8,["modelValue","invalid","content-loading"]),a(he,{position:"bottom-end"},{activator:c(()=>[a(ge,{"content-loading":t.loading,class:"rounded-tr-md rounded-br-md !p-2 rounded-none",type:"button",variant:"white"},{default:c(()=>[n("span",ut,[L(h(t.itemData.discount_type=="fixed"?t.currency.symbol:"%")+" ",1),a(re,{name:"ChevronDownIcon",class:"w-4 h-4 text-gray-500 ml-1"})])]),_:1},8,["content-loading"])]),default:c(()=>[a(le,{onClick:g},{default:c(()=>[L(h(f.$t("general.fixed")),1)]),_:1}),a(le,{onClick:v},{default:c(()=>[L(h(f.$t("general.percentage")),1)]),_:1})]),_:1})])])])):A("",!0),n("td",mt,[n("div",pt,[n("span",null,[t.loading?(l(),D(de,{key:0},{default:c(()=>[a(ie,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),D(_e,{key:1,amount:o(q),currency:o(j)},null,8,["amount","currency"]))]),n("div",yt,[o(I)?(l(),D(re,{key:0,class:"h-5 text-gray-700 cursor-pointer",name:"TrashIcon",onClick:C[5]||(C[5]=N=>t.store.removeItem(t.index))})):A("",!0)])])])]),t.store[t.storeProp].tax_per_item==="YES"?(l(),b("tr",xt,[ft,n("td",gt,[t.loading?(l(),D(de,{key:0},{default:c(()=>[a(ie,{lines:1,class:"w-24 h-8 rounded-md border"})]),_:1})):(l(!0),b(Z,{key:1},ee(t.itemData.taxes,(N,be)=>(l(),D(Ge,{key:N.id,index:be,"item-index":t.index,"tax-data":N,taxes:t.itemData.taxes,"discounted-total":o(q),"total-tax":o(d),total:o(P),currency:t.currency,"update-items":V,ability:o(se).CREATE_INVOICE,store:t.store,"store-prop":t.storeProp,onUpdate:x},null,8,["index","item-index","tax-data","taxes","discounted-total","total-tax","total","currency","ability","store","store-prop"]))),128))])])):A("",!0)])])])])}}},_t={class:"text-center item-table min-w-full"},bt=n("col",{style:{width:"40%","min-width":"280px"}},null,-1),vt=n("col",{style:{width:"10%","min-width":"120px"}},null,-1),$t=n("col",{style:{width:"15%","min-width":"120px"}},null,-1),wt={key:0,style:{width:"15%","min-width":"160px"}},St=n("col",{style:{width:"15%","min-width":"120px"}},null,-1),Bt={class:"bg-white border border-gray-200 border-solid"},It={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-left text-gray-700 border-t border-b border-gray-200 border-solid"},Tt={key:1,class:"pl-7"},Pt={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-right text-gray-700 border-t border-b border-gray-200 border-solid"},kt={key:1},Ct={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-left text-gray-700 border-t border-b border-gray-200 border-solid"},Mt={key:1},Dt={key:0,class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-left text-gray-700 border-t border-b border-gray-200 border-solid"},Vt={key:1},jt={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-right text-gray-700 border-t border-b border-gray-200 border-solid"},qt={key:1,class:"pr-10 column-heading"},zs={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},currency:{type:[Object,String,null],required:!0},isLoading:{type:Boolean,default:!1},itemValidationScope:{type:String,default:""}},setup(t){const s=t,e=Q(),i=S(()=>s.currency?s.currency:e.selectedCompanyCurrency);return(w,$)=>{const B=p("BaseContentPlaceholdersText"),y=p("BaseContentPlaceholders"),P=p("BaseIcon");return l(),b(Z,null,[n("table",_t,[n("colgroup",null,[bt,vt,$t,t.store[t.storeProp].discount_per_item==="YES"?(l(),b("col",wt)):A("",!0),St]),n("thead",Bt,[n("tr",null,[n("th",It,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[a(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("span",Tt,h(w.$tc("items.item",2)),1))]),n("th",Pt,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[a(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("span",kt,h(w.$t("invoices.item.quantity")),1))]),n("th",Ct,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[a(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("span",Mt,h(w.$t("invoices.item.price")),1))]),t.store[t.storeProp].discount_per_item==="YES"?(l(),b("th",Dt,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[a(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("span",Vt,h(w.$t("invoices.item.discount")),1))])):A("",!0),n("th",jt,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[a(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("span",qt,h(w.$t("invoices.item.amount")),1))])])]),a(o(Ie),{modelValue:t.store[t.storeProp].items,"onUpdate:modelValue":$[0]||($[0]=m=>t.store[t.storeProp].items=m),"item-key":"id",tag:"tbody",handle:".handle"},{item:c(({element:m,index:q})=>[(l(),D(ht,{key:m.id,index:q,"item-data":m,loading:t.isLoading,currency:o(i),"item-validation-scope":t.itemValidationScope,"invoice-items":t.store[t.storeProp].items,store:t.store,"store-prop":t.storeProp},null,8,["index","item-data","loading","currency","item-validation-scope","invoice-items","store","store-prop"]))]),_:1},8,["modelValue"])]),n("div",{class:"flex items-center justify-center w-full px-6 py-3 text-base border border-t-0 border-gray-200 border-solid cursor-pointer text-primary-400 hover:bg-primary-100",onClick:$[1]||($[1]=(...m)=>t.store.addItem&&t.store.addItem(...m))},[a(P,{name:"PlusCircleIcon",class:"mr-2"}),L(" "+h(w.$t("general.add_new_item")),1)])],64)}}},Lt={class:"flex items-center justify-between w-full mt-2 text-sm"},Et={class:"font-semibold leading-5 text-gray-500 uppercase"},At={class:"flex items-center justify-center text-lg text-black"},Ot={props:{index:{type:Number,required:!0},tax:{type:Object,required:!0},taxes:{type:Array,required:!0},currency:{type:[Object,String],required:!0},store:{type:Object,default:null},data:{type:String,default:""}},emits:["update","remove"],setup(t,{emit:s}){const e=t;oe("$utils");const i=S(()=>e.tax.compound_tax&&e.store.getSubtotalWithDiscount?Math.round((e.store.getSubtotalWithDiscount+e.store.getTotalSimpleTax)*e.tax.percent/100):e.store.getSubtotalWithDiscount&&e.tax.percent?Math.round(e.store.getSubtotalWithDiscount*e.tax.percent/100):0);Ce(()=>{e.store.getSubtotalWithDiscount&&w(),e.store.getTotalSimpleTax&&w()});function w(){s("update",{...e.tax,amount:i.value})}return($,B)=>{const y=p("BaseFormatMoney"),P=p("BaseIcon");return l(),b("div",Lt,[n("label",Et,h(t.tax.name)+" ("+h(t.tax.percent)+" %) ",1),n("label",At,[a(y,{amount:t.tax.amount,currency:t.currency},null,8,["amount","currency"]),a(P,{name:"TrashIcon",class:"h-5 ml-2 cursor-pointer",onClick:B[0]||(B[0]=m=>$.$emit("remove",t.tax.id))})])])}}},Ut={class:"w-full mt-4 tax-select"},zt={class:"relative w-full max-w-md px-4"},Nt={class:"overflow-hidden rounded-md shadow-lg ring-1 ring-black ring-opacity-5"},Ft={class:"relative bg-white"},Yt={class:"relative p-4"},Gt={key:0,class:"relative flex flex-col overflow-auto list max-h-36 border-t border-gray-200"},Wt=["onClick"],Rt={class:"flex justify-between px-2"},Xt={class:"m-0 text-base font-semibold leading-tight text-gray-700 cursor-pointer"},Ht={class:"m-0 text-base font-semibold text-gray-700 cursor-pointer"},Jt={key:1,class:"flex justify-center p-5 text-gray-400"},Zt={class:"text-base text-gray-500 cursor-pointer"},Kt={class:"m-0 ml-3 text-sm leading-none cursor-pointer font-base text-primary-400"},Qt={props:{type:{type:String,default:null},store:{type:Object,default:null},storeProp:{type:String,default:""}},emits:["select:taxType"],setup(t,{emit:s}){const e=t,i=W(),w=K(),$=ce(),{t:B}=R(),y=F(null),P=S(()=>y.value?w.taxTypes.filter(function(I){return I.name.toLowerCase().indexOf(y.value.toLowerCase())!==-1}):w.taxTypes),m=S(()=>e.store[e.storeProp].taxes);function q(I,d){s("select:taxType",{...I}),d()}function j(){i.openModal({title:B("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:I=>s("select:taxType",I)})}return(I,d)=>{const r=p("BaseIcon"),u=p("BaseInput");return l(),b("div",Ut,[a(o(je),{class:"relative"},{default:c(({isOpen:_})=>[a(o(Me),{class:G([_?"":"text-opacity-90","flex items-center text-sm font-medium text-primary-400 focus:outline-none focus:border-none"])},{default:c(()=>[a(r,{name:"PlusIcon",class:"w-4 h-4 font-medium text-primary-400"}),L(" "+h(I.$t("settings.tax_types.add_tax")),1)]),_:2},1032,["class"]),n("div",zt,[a(De,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:c(()=>[a(o(Ve),{style:{"min-width":"350px","margin-left":"62px",top:"-28px"},class:"absolute z-10 px-4 py-2 -translate-x-full sm:px-0"},{default:c(({close:k})=>[n("div",Nt,[n("div",Ft,[n("div",Yt,[a(u,{modelValue:y.value,"onUpdate:modelValue":d[0]||(d[0]=x=>y.value=x),placeholder:I.$t("general.search"),type:"text",class:"text-black"},null,8,["modelValue","placeholder"])]),o(P).length>0?(l(),b("div",Gt,[(l(!0),b(Z,null,ee(o(P),(x,M)=>(l(),b("div",{key:M,class:G([{"bg-gray-100 cursor-not-allowed opacity-50 pointer-events-none":o(m).find(T=>T.tax_type_id===x.id)},"px-6 py-4 border-b border-gray-200 border-solid cursor-pointer hover:bg-gray-100 hover:cursor-pointer last:border-b-0"]),tabindex:"2",onClick:T=>q(x,k)},[n("div",Rt,[n("label",Xt,h(x.name),1),n("label",Ht,h(x.percent)+" % ",1)])],10,Wt))),128))])):(l(),b("div",Jt,[n("label",Zt,h(I.$t("general.no_tax_found")),1)]))]),o($).hasAbilities(o(se).CREATE_TAX_TYPE)?(l(),b("button",{key:0,type:"button",class:"flex items-center justify-center w-full h-10 px-2 py-3 bg-gray-200 border-none outline-none",onClick:j},[a(r,{name:"CheckCircleIcon",class:"text-primary-400"}),n("label",Kt,h(I.$t("estimates.add_new_tax")),1)])):A("",!0)])]),_:1})]),_:1})])]),_:1})])}}},es={class:"px-5 py-4 mt-6 bg-white border border-gray-200 border-solid rounded md:min-w-[390px] min-w-[300px] lg:mt-7"},ts={class:"flex items-center justify-between w-full"},ss={key:1,class:"text-sm font-semibold leading-5 text-gray-400 uppercase"},os={key:3,class:"flex items-center justify-center m-0 text-lg text-black uppercase"},ns={key:1,class:"m-0 text-sm font-semibold leading-5 text-gray-500 uppercase"},as={key:3,class:"flex items-center justify-center m-0 text-lg text-black uppercase"},rs={key:0,class:"flex items-center justify-between w-full mt-2"},ls={key:1,class:"text-sm font-semibold leading-5 text-gray-400 uppercase"},is={key:3,class:"flex",style:{width:"140px"},role:"group"},ds={class:"flex items-center"},cs={key:1},us={class:"flex items-center justify-between w-full pt-2 mt-5 border-t border-gray-200 border-solid"},ms={key:1,class:"m-0 text-sm font-semibold leading-5 text-gray-400 uppercase"},ps={key:3,class:"flex items-center justify-center text-lg uppercase text-primary-400"},Ns={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},taxPopupType:{type:String,default:""},currency:{type:[Object,String],default:""},isLoading:{type:Boolean,default:!1}},setup(t){const s=t,e=F(null);oe("$utils");const i=Q(),w=S({get:()=>s.store[s.storeProp].discount,set:d=>{s.store[s.storeProp].discount_type==="percentage"?s.store[s.storeProp].discount_val=Math.round(s.store.getSubTotal*d/100):s.store[s.storeProp].discount_val=Math.round(d*100),s.store[s.storeProp].discount=d}}),$=S({get:()=>s.store[s.storeProp].taxes,set:d=>{s.store.$patch(r=>{r[s.storeProp].taxes=d})}}),B=S(()=>{let d=[];return s.store[s.storeProp].items.forEach(r=>{r.taxes&&r.taxes.forEach(u=>{let _=d.find(k=>k.tax_type_id===u.tax_type_id);_?_.amount+=u.amount:u.tax_type_id&&d.push({tax_type_id:u.tax_type_id,amount:u.amount,percent:u.percent,name:u.name})})}),d}),y=S(()=>s.currency?s.currency:i.selectedCompanyCurrency);function P(){s.store[s.storeProp].discount_type!=="fixed"&&(s.store[s.storeProp].discount_val=Math.round(s.store[s.storeProp].discount*100),s.store[s.storeProp].discount_type="fixed")}function m(){s.store[s.storeProp].discount_type!=="percentage"&&(s.store[s.storeProp].discount_val=s.store.getSubTotal*s.store[s.storeProp].discount/100,s.store[s.storeProp].discount_type="percentage")}function q(d){let r=0;d.compound_tax&&s.store.getSubtotalWithDiscount?r=Math.round((s.store.getSubtotalWithDiscount+s.store.getTotalSimpleTax)*d.percent/100):s.store.getSubtotalWithDiscount&&d.percent&&(r=Math.round(s.store.getSubtotalWithDiscount*d.percent/100));let u={...se,id:ye.raw(),name:d.name,percent:d.percent,compound_tax:d.compound_tax,tax_type_id:d.id,amount:r};s.store.$patch(_=>{_[s.storeProp].taxes.push({...u})})}function j(d){const r=s.store[s.storeProp].taxes.find(u=>u.id===d.id);r&&Object.assign(r,{...d})}function I(d){const r=s.store[s.storeProp].taxes.findIndex(u=>u.id===d);s.store.$patch(u=>{u[s.storeProp].taxes.splice(r,1)})}return(d,r)=>{const u=p("BaseContentPlaceholdersText"),_=p("BaseContentPlaceholders"),k=p("BaseFormatMoney"),x=p("BaseInput"),M=p("BaseIcon"),T=p("BaseButton"),g=p("BaseDropdownItem"),v=p("BaseDropdown");return l(),b("div",es,[n("div",ts,[t.isLoading?(l(),D(_,{key:0},{default:c(()=>[a(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("label",ss,h(d.$t("estimates.sub_total")),1)),t.isLoading?(l(),D(_,{key:2},{default:c(()=>[a(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("label",os,[a(k,{amount:t.store.getSubTotal,currency:o(y)},null,8,["amount","currency"])]))]),(l(!0),b(Z,null,ee(o(B),V=>(l(),b("div",{key:V.tax_type_id,class:"flex items-center justify-between w-full"},[t.isLoading?(l(),D(_,{key:0},{default:c(()=>[a(u,{lines:1,class:"w-16 h-5"})]),_:1})):t.store[t.storeProp].tax_per_item==="YES"?(l(),b("label",ns,h(V.name)+" - "+h(V.percent)+"% ",1)):A("",!0),t.isLoading?(l(),D(_,{key:2},{default:c(()=>[a(u,{lines:1,class:"w-16 h-5"})]),_:1})):t.store[t.storeProp].tax_per_item==="YES"?(l(),b("label",as,[a(k,{amount:V.amount,currency:o(y)},null,8,["amount","currency"])])):A("",!0)]))),128)),t.store[t.storeProp].discount_per_item==="NO"||t.store[t.storeProp].discount_per_item===null?(l(),b("div",rs,[t.isLoading?(l(),D(_,{key:0},{default:c(()=>[a(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("label",ls,h(d.$t("estimates.discount")),1)),t.isLoading?(l(),D(_,{key:2},{default:c(()=>[a(u,{lines:1,class:"w-24 h-8 rounded-md border"})]),_:1})):(l(),b("div",is,[a(x,{modelValue:o(w),"onUpdate:modelValue":r[0]||(r[0]=V=>J(w)?w.value=V:null),class:"border-r-0 focus:border-r-2 rounded-tr-sm rounded-br-sm h-[38px]"},null,8,["modelValue"]),a(v,{position:"bottom-end"},{activator:c(()=>[a(T,{class:"rounded-tr-md rounded-br-md p-2 rounded-none",type:"button",variant:"white"},{default:c(()=>[n("span",ds,[L(h(t.store[t.storeProp].discount_type=="fixed"?o(y).symbol:"%")+" ",1),a(M,{name:"ChevronDownIcon",class:"w-4 h-4 text-gray-500 ml-1"})])]),_:1})]),default:c(()=>[a(g,{onClick:P},{default:c(()=>[L(h(d.$t("general.fixed")),1)]),_:1}),a(g,{onClick:m},{default:c(()=>[L(h(d.$t("general.percentage")),1)]),_:1})]),_:1})]))])):A("",!0),t.store[t.storeProp].tax_per_item==="NO"||t.store[t.storeProp].tax_per_item===null?(l(),b("div",cs,[(l(!0),b(Z,null,ee(o($),(V,E)=>(l(),D(Ot,{key:V.id,index:E,tax:V,taxes:o($),currency:t.currency,store:t.store,onRemove:I,onUpdate:j},null,8,["index","tax","taxes","currency","store"]))),128))])):A("",!0),t.store[t.storeProp].tax_per_item==="NO"||t.store[t.storeProp].tax_per_item===null?(l(),b("div",{key:2,ref_key:"taxModal",ref:e,class:"float-right pt-2 pb-4"},[a(Qt,{"store-prop":t.storeProp,store:t.store,type:t.taxPopupType,"onSelect:taxType":q},null,8,["store-prop","store","type"])],512)):A("",!0),n("div",us,[t.isLoading?(l(),D(_,{key:0},{default:c(()=>[a(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("label",ms,h(d.$t("estimates.total"))+" "+h(d.$t("estimates.amount"))+":",1)),t.isLoading?(l(),D(_,{key:2},{default:c(()=>[a(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),b("label",ps,[a(k,{amount:t.store.getTotal,currency:o(y)},null,8,["amount","currency"])]))])])}}},ys={class:"flex text-gray-800 font-medium text-sm mb-2"},xs=n("span",{class:"text-sm text-red-500"}," *",-1),Fs={props:{store:{type:Object,default:null},storeProp:{type:String,default:""}},setup(t){const s=t,e=W(),{t:i}=R();function w(){e.openModal({title:i("general.choose_template"),componentName:"SelectTemplate",data:{templates:s.store.templates,store:s.store,storeProp:s.storeProp}})}return($,B)=>{const y=p("BaseIcon"),P=p("BaseButton");return l(),b("div",null,[n("label",ys,[L(h($.$t("general.select_template"))+" ",1),xs]),a(P,{type:"button",class:"flex justify-center w-full text-sm lg:w-auto hover:bg-gray-200",variant:"gray",onClick:w},{right:c(m=>[a(y,{name:"PencilIcon",class:G(m.class)},null,8,["class"])]),default:c(()=>[L(" "+h(t.store[t.storeProp].template_name),1)]),_:1})])}}},fs={class:"mb-6"},gs={class:"z-20 text-sm font-semibold leading-5 text-primary-400 float-right"},hs={class:"text-gray-800 font-medium mb-4 text-sm"},Ys={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},fields:{type:Object,default:null},type:{type:String,default:null}},setup(t){const s=t;function e(i){s.store[s.storeProp].notes=""+i.notes}return(i,w)=>{const $=p("BaseCustomInput");return l(),b("div",fs,[n("div",gs,[a(Le,{type:t.type,onSelect:e},null,8,["type"])]),n("label",hs,h(i.$t("invoices.notes")),1),a($,{modelValue:t.store[t.storeProp].notes,"onUpdate:modelValue":w[0]||(w[0]=B=>t.store[t.storeProp].notes=B),"content-loading":t.store.isFetchingInitialSettings,fields:t.fields,class:"mt-1"},null,8,["modelValue","content-loading","fields"])])}}},_s={class:"flex justify-between w-full"},bs={class:"px-8 py-8 sm:p-6"},vs={key:0,class:"grid grid-cols-3 gap-2 p-1 overflow-x-auto"},$s=["src","alt","onClick"],ws=["alt","src"],Ss={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},Gs={setup(t){const s=W(),e=F(""),i=S(()=>s.active&&s.componentName==="SelectTemplate"),w=S(()=>s.title);function $(){s.data.store[s.data.storeProp].template_name?e.value=s.data.store[s.data.storeProp].template_name:e.value=s.data.templates[0]}async function B(){await s.data.store.setTemplate(e.value),P()}function y(){return new URL("/build/img/tick.png",self.location)}function P(){s.closeModal(),setTimeout(()=>{s.$reset()},300)}return(m,q)=>{const j=p("BaseIcon"),I=p("BaseButton"),d=p("BaseModal");return l(),D(d,{show:o(i),onClose:P,onOpen:$},{header:c(()=>[n("div",_s,[L(h(o(w))+" ",1),a(j,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:P})])]),default:c(()=>[n("div",bs,[o(s).data?(l(),b("div",vs,[(l(!0),b(Z,null,ee(o(s).data.templates,(r,u)=>(l(),b("div",{key:u,class:G([{"border border-solid border-primary-500":e.value===r.name},"relative flex flex-col m-2 border border-gray-200 border-solid cursor-pointer hover:border-primary-300"])},[n("img",{src:r.path,alt:r.name,class:"w-full",onClick:_=>e.value=r.name},null,8,$s),e.value===r.name?(l(),b("img",{key:0,alt:r.name,class:"absolute z-10 w-5 h-5 text-primary-500",style:{top:"-6px",right:"-5px"},src:y()},null,8,ws)):A("",!0),n("span",{class:G(["w-full p-1 bg-gray-200 text-sm text-center absolute bottom-0 left-0",{"text-primary-500 bg-primary-100":e.value===r.name,"text-gray-600":e.value!=r.name}])},h(r.name),3)],2))),128))])):A("",!0)]),n("div",Ss,[a(I,{class:"mr-3",variant:"primary-outline",onClick:P},{default:c(()=>[L(h(m.$t("general.cancel")),1)]),_:1}),a(I,{variant:"primary",onClick:q[0]||(q[0]=r=>B())},{left:c(r=>[a(j,{name:"SaveIcon",class:G(r.class)},null,8,["class"])]),default:c(()=>[L(" "+h(m.$t("general.choose")),1)]),_:1})])]),_:1},8,["show"])}}},Bs={class:"flex justify-between w-full"},Is={class:"item-modal"},Ts=["onSubmit"],Ps={class:"px-8 py-8 sm:p-6"},ks={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},Ws={emits:["newItem"],setup(t,{emit:s}){const e=W(),i=ue(),w=Q(),$=K();$e(),we();const{t:B}=R(),y=F(!1),P=F(w.selectedCompanySettings.tax_per_item),m=S(()=>e.active&&e.componentName==="ItemModal"),q=S({get:()=>i.currentItem.price/100,set:x=>{i.currentItem.price=Math.round(x*100)}}),j=S({get:()=>i.currentItem.taxes.map(x=>{if(x)return{...x,tax_type_id:x.id,tax_name:x.name+" ("+x.percent+"%)"}}),set:x=>{i.$patch(M=>{M.currentItem.taxes=x})}}),I=S(()=>P.value==="YES"),d={name:{required:O.withMessage(B("validation.required"),Y),minLength:O.withMessage(B("validation.name_min_length",{count:3}),qe(3))},description:{maxLength:O.withMessage(B("validation.description_maxlength",{count:255}),te(255))}},r=ae(d,S(()=>i.currentItem)),u=S(()=>$.taxTypes.map(x=>({...x,tax_name:x.name+" ("+x.percent+"%)"})));xe(()=>{r.value.$reset(),i.fetchItemUnits({limit:"all"})});async function _(){if(r.value.$touch(),r.value.$invalid)return!0;let x={...i.currentItem,taxes:i.currentItem.taxes.map(T=>({tax_type_id:T.id,amount:q.value*T.percent/100,percent:T.percent,name:T.name,collective_tax:0}))};y.value=!0,await(i.isEdit?i.updateItem:i.addItem)(x).then(T=>{y.value=!1,T.data.data&&e.data&&e.refreshData(T.data.data),k()})}function k(){e.closeModal(),setTimeout(()=>{i.resetCurrentItem(),e.$reset(),r.value.$reset()},300)}return(x,M)=>{const T=p("BaseIcon"),g=p("BaseInput"),v=p("BaseInputGroup"),V=p("BaseMoney"),E=p("BaseMultiselect"),f=p("BaseTextarea"),C=p("BaseInputGrid"),z=p("BaseButton"),H=p("BaseModal");return l(),D(H,{show:o(m),onClose:k},{header:c(()=>[n("div",Bs,[L(h(o(e).title)+" ",1),a(T,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:k})])]),default:c(()=>[n("div",Is,[n("form",{action:"",onSubmit:fe(_,["prevent"])},[n("div",Ps,[a(C,{layout:"one-column"},{default:c(()=>[a(v,{label:x.$t("items.name"),required:"",error:o(r).name.$error&&o(r).name.$errors[0].$message},{default:c(()=>[a(g,{modelValue:o(i).currentItem.name,"onUpdate:modelValue":M[0]||(M[0]=U=>o(i).currentItem.name=U),type:"text",invalid:o(r).name.$error,onInput:M[1]||(M[1]=U=>o(r).name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(v,{label:x.$t("items.price")},{default:c(()=>[(l(),D(V,{key:o(w).selectedCompanyCurrency,modelValue:o(q),"onUpdate:modelValue":M[2]||(M[2]=U=>J(q)?q.value=U:null),currency:o(w).selectedCompanyCurrency,class:"relative w-full focus:border focus:border-solid focus:border-primary"},null,8,["modelValue","currency"]))]),_:1},8,["label"]),a(v,{label:x.$t("items.unit")},{default:c(()=>[a(E,{modelValue:o(i).currentItem.unit_id,"onUpdate:modelValue":M[3]||(M[3]=U=>o(i).currentItem.unit_id=U),label:"name",options:o(i).itemUnits,"value-prop":"id","can-deselect":!1,"can-clear":!1,placeholder:x.$t("items.select_a_unit"),searchable:"","track-by":"id"},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),o(I)?(l(),D(v,{key:0,label:x.$t("items.taxes")},{default:c(()=>[a(E,{modelValue:o(j),"onUpdate:modelValue":M[4]||(M[4]=U=>J(j)?j.value=U:null),options:o(u),label:"name","value-prop":"id",class:"w-full","can-deselect":!1,"can-clear":!1,searchable:"","track-by":"id",object:""},null,8,["modelValue","options"])]),_:1},8,["label"])):A("",!0),a(v,{label:x.$t("items.description"),error:o(r).description.$error&&o(r).description.$errors[0].$message},{default:c(()=>[a(f,{modelValue:o(i).currentItem.description,"onUpdate:modelValue":M[5]||(M[5]=U=>o(i).currentItem.description=U),rows:"4",cols:"50",invalid:o(r).description.$error,onInput:M[6]||(M[6]=U=>o(r).description.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})]),n("div",ks,[a(z,{class:"mr-3",variant:"primary-outline",type:"button",onClick:k},{default:c(()=>[L(h(x.$t("general.cancel")),1)]),_:1}),a(z,{loading:y.value,disabled:y.value,variant:"primary",type:"submit"},{left:c(U=>[a(T,{name:"SaveIcon",class:G(U.class)},null,8,["class"])]),default:c(()=>[L(" "+h(o(i).isEdit?x.$t("general.update"):x.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,Ts)])]),_:1},8,["show"])}}},Cs={class:"flex justify-between w-full"},Ms={class:"flex flex-col"},Ds={class:"text-sm text-gray-500 mt-1"},Vs=["onSubmit"],js={class:"p-4 sm:p-6"},qs={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},Ls={emits:["addTax"],setup(t,{emit:s}){const e=W();Se();const i=me({state:"",city:"",address_street_1:"",zip:""}),w=F(!1),$=K(),{t:B}=R(),y=S(()=>e.active&&e.componentName==="TaxationAddressModal"),P=S(()=>({state:{required:O.withMessage(B("validation.required"),Y)},city:{required:O.withMessage(B("validation.required"),Y)},address_street_1:{required:O.withMessage(B("validation.required"),Y)},zip:{required:O.withMessage(B("validation.required"),Y)}})),m=ae(P,S(()=>i));async function q(){if(m.value.$touch(),m.value.$invalid)return!0;let d={address:i};e.id&&(d.customer_id=e.id),i.address_street_1=i.address_street_1.replace(/(\r\n|\n|\r)/gm,""),w.value=!0,await $.fetchSalesTax(d).then(r=>{w.value=!1,s("addTax",r.data.data),I()}).catch(r=>{w.value=!1})}function j(){i.state=e?.data?.state,i.city=e?.data?.city,i.address_street_1=e?.data?.address_street_1,i.zip=e?.data?.zip}function I(){e.closeModal()}return(d,r)=>{const u=p("BaseIcon"),_=p("BaseInput"),k=p("BaseInputGroup"),x=p("BaseTextarea"),M=p("BaseInputGrid"),T=p("BaseButton"),g=p("BaseModal");return l(),D(g,{show:o(y),onClose:I,onOpen:j},{header:c(()=>[n("div",Cs,[n("div",Ms,[L(h(o(e).title)+" ",1),n("p",Ds,h(o(e).content),1)]),a(u,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:I})])]),default:c(()=>[n("form",{onSubmit:fe(q,["prevent"])},[n("div",js,[a(M,{layout:"one-column"},{default:c(()=>[a(k,{required:"",error:o(m).state.$error&&o(m).state.$errors[0].$message,label:d.$t("customers.state")},{default:c(()=>[a(_,{modelValue:o(i).state,"onUpdate:modelValue":r[0]||(r[0]=v=>o(i).state=v),type:"text",name:"shippingState",class:"mt-1 md:mt-0",invalid:o(m).state.$error,onInput:r[1]||(r[1]=v=>o(m).state.$touch()),placeholder:d.$t("settings.taxations.state_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"]),a(k,{required:"",error:o(m).city.$error&&o(m).city.$errors[0].$message,label:d.$t("customers.city")},{default:c(()=>[a(_,{modelValue:o(i).city,"onUpdate:modelValue":r[2]||(r[2]=v=>o(i).city=v),type:"text",name:"shippingCity",class:"mt-1 md:mt-0",invalid:o(m).city.$error,onInput:r[3]||(r[3]=v=>o(m).city.$touch()),placeholder:d.$t("settings.taxations.city_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"]),a(k,{required:"",error:o(m).address_street_1.$error&&o(m).address_street_1.$errors[0].$message,label:d.$t("customers.address")},{default:c(()=>[a(x,{modelValue:o(i).address_street_1,"onUpdate:modelValue":r[4]||(r[4]=v=>o(i).address_street_1=v),rows:"2",cols:"50",class:"mt-1 md:mt-0",invalid:o(m).address_street_1.$error,onInput:r[5]||(r[5]=v=>o(m).address_street_1.$touch()),placeholder:d.$t("settings.taxations.address_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"]),a(k,{required:"",error:o(m).zip.$error&&o(m).zip.$errors[0].$message,label:d.$t("customers.zip_code")},{default:c(()=>[a(_,{modelValue:o(i).zip,"onUpdate:modelValue":r[6]||(r[6]=v=>o(i).zip=v),invalid:o(m).zip.$error,onInput:r[7]||(r[7]=v=>o(m).zip.$touch()),type:"text",class:"mt-1 md:mt-0",placeholder:d.$t("settings.taxations.zip_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"])]),_:1})]),n("div",qs,[a(T,{class:"mr-3 text-sm",type:"button",variant:"primary-outline",onClick:I},{default:c(()=>[L(h(d.$t("general.cancel")),1)]),_:1}),a(T,{loading:w.value,variant:"primary",type:"submit"},{left:c(v=>[w.value?A("",!0):(l(),D(u,{key:0,name:"SaveIcon",class:G(v.class)},null,8,["class"]))]),default:c(()=>[L(" "+h(d.$t("general.save")),1)]),_:1},8,["loading"])])],40,Vs)]),_:1},8,["show"])}}},Rs={props:{isEdit:{type:Boolean,default:null},type:{type:String,default:null},customer:{type:[Object],default:null},store:{type:Object,default:null},storeProp:{type:String,default:null}},setup(t){const s=t,e="Sales Tax",i="MODULE",w=W(),$=Q(),B=K(),{t:y}=R(),P=F(!1),m=S(()=>s.isEdit?s.store[s.storeProp].sales_tax_address_type==="billing":$.selectedCompanySettings.sales_tax_address_type==="billing"),q=S(()=>$.selectedCompanySettings.sales_tax_us_enabled==="YES"),j=S(()=>s.isEdit?s.store[s.storeProp].sales_tax_type==="customer_level":$.selectedCompanySettings.sales_tax_type==="customer_level"),I=S(()=>s.isEdit?s.store[s.storeProp].sales_tax_type==="company_level":$.selectedCompanySettings.sales_tax_type==="company_level"),d=S(()=>{if(j.value&&r.value){let g=m.value?s.customer.billing:s.customer.shipping;return{address:X.exports.pick(g,["address_street_1","city","state","zip"]),customer_id:s.customer.id}}else if(I.value&&r.value)return{address:X.exports.pick(address,["address_street_1","city","state","zip"])}}),r=S(()=>{if(j.value){let g=m.value?s.customer?.billing:s.customer?.shipping;return u(g)}else if(I.value)return u($.selectedCompany.address);return!1});ne(()=>s.customer,(g,v)=>{if(g&&v&&j.value){_(g,v);return}!r.value&&j.value&&g?setTimeout(()=>{k()},500):j.value&&g?x():j.value&&!g&&T()}),xe(()=>{I.value&&(r.value?x():k())});function u(g){return g?g.address_street_1&&g.city&&g.state&&g.zip:!1}function _(g,v){const V=m.value?g.billing:g.shipping,E=m.value?v.billing:v.shipping,f=X.exports.pick(V,["address_street_1","city","state","zip"]),C=X.exports.pick(E,["address_street_1","city","state","zip"]);X.exports.isEqual(f,C)||x()}function k(){if(!q.value)return;let g=null,v="";j.value?m.value?(g=s.customer?.billing,v=y("settings.taxations.add_billing_address")):(g=s.customer?.shipping,v=y("settings.taxations.add_shipping_address")):(g=$.selectedCompany.address,v=y("settings.taxations.add_company_address")),w.openModal({title:v,content:y("settings.taxations.modal_description"),componentName:"TaxationAddressModal",data:g,id:j.value?s.customer.id:""})}async function x(){!q.value||(P.value=!0,await B.fetchSalesTax(d.value).then(g=>{M(g.data.data),P.value=!1}).catch(g=>{g.response.data.error&&setTimeout(()=>{k()},500),P.value=!1}))}function M(g){g.tax_type_id=g.id;const v=s.store[s.storeProp].taxes.findIndex(V=>V.name===e&&V.type===i);v>-1?Object.assign(s.store[s.storeProp].taxes[v],g):s.store[s.storeProp].taxes.push(g)}function T(){const g=s.store[s.storeProp].taxes.findIndex(V=>V.name===e&&V.type===i);g>-1&&s.store[s.storeProp].taxes.splice(g,1);let v=B.taxTypes.findIndex(V=>V.name===e&&V.type===i);v>-1&&B.taxTypes.splice(v,1)}return(g,v)=>(l(),D(Ls,{onAddTax:M}))}};export{Gs as _,Ws as a,Rs as b,zs as c,Ys as d,Fs as e,Ns as f};
