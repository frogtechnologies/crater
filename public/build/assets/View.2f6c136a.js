import{G as W,aN as X,J as Z,B as u,a0 as D,ah as ee,k as g,C as te,A as ae,r as d,o as i,e as y,f as s,w as n,u as e,l as B,i as se,t as f,j as _,h as r,F as $,y as oe,m as ne,I as re}from"./vendor.8669b7df.js";import{c as le,e as de,j as ie,g as ce}from"./main.8525167c.js";import{u as me}from"./payment.dbc88c1c.js";import{_ as ue,a as pe}from"./SendPaymentModal.f2e3b0c7.js";import{L as ye}from"./LoadingIcon.5e488a35.js";import"./mail-driver.12e9c4e5.js";const fe={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 ml-56 bg-white xl:ml-64 w-88 xl:block"},_e={class:"flex items-center justify-between px-4 pt-8 pb-6 border border-gray-200 border-solid"},he={class:"flex ml-3",role:"group","aria-label":"First group"},be={class:"px-4 py-1 pb-2 mb-2 text-sm border-b border-gray-200 border-solid"},ge={class:"px-2"},Be={class:"px-2"},ve={class:"px-2"},xe={key:0,class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid"},we={class:"flex-2"},ke={class:"mb-1 text-xs not-italic font-medium leading-5 text-gray-500 capitalize"},Ie={class:"mb-1 text-xs not-italic font-medium leading-5 text-gray-500 capitalize"},Fe={class:"flex-1 whitespace-nowrap right"},Se={class:"text-sm text-right text-gray-500 non-italic"},Ve={class:"flex justify-center p-4 items-center"},Pe={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},je={class:"flex flex-col min-h-0 mt-8 overflow-hidden",style:{height:"75vh"}},Te=["src"],Ue={setup(De){const h=W();X();const{t:w}=Z();u(null),u(null);let p=D({});u(null);let t=D({orderBy:null,orderByField:null,searchText:null}),k=u(!1),M=u(!1);u(!1);let b=u(!1),v=u(!1);ee("utils");const c=me(),z=le(),N=de(),C=g(()=>p.payment_number||""),P=g(()=>t.orderBy==="asc"||t.orderBy==null);g(()=>P.value?w("general.ascending"):w("general.descending"));const j=g(()=>p.unique_hash?`/payments/pdf/${p.unique_hash}`:!1);g(()=>re(c?.selectedPayment?.payment_date).format("YYYY/MM/DD")),te(h,()=>{T()}),U(),T(),m=ae.exports.debounce(m,500);function L(a){return h.params.id==a}ie();async function U(){b.value=!0,await c.fetchPayments({limit:"all"}),b.value=!1,setTimeout(()=>{A()},500)}async function T(){if(!h.params.id)return;v.value=!0;let a=await c.fetchPayment(h.params.id);a.data&&(v.value=!1,Object.assign(p,a.data.data))}function A(){const a=document.getElementById(`payment-${h.params.id}`);a&&(a.scrollIntoView({behavior:"smooth"}),a.classList.add("shake"))}async function m(){let a={};t.searchText!==""&&t.searchText!==null&&t.searchText!==void 0&&(a.search=t.searchText),t.orderBy!==null&&t.orderBy!==void 0&&(a.orderBy=t.orderBy),t.orderByField!==null&&t.orderByField!==void 0&&(a.orderByField=t.orderByField),k.value=!0;try{let l=await c.searchPayment(a);k.value=!1,l.data.data&&(c.payments=l.data.data)}catch{k.value=!1}}function E(){return t.orderBy==="asc"?(t.orderBy="desc",m(),!0):(t.orderBy="asc",m(),!0)}async function Y(){z.openModal({title:w("payments.send_payment"),componentName:"SendPaymentModal",id:p.id,data:p,variant:"lg"})}return(a,l)=>{const I=d("BaseButton"),R=d("BasePageHeader"),x=d("BaseIcon"),G=d("BaseInput"),F=d("BaseRadio"),S=d("BaseInputGroup"),V=d("BaseDropdownItem"),q=d("BaseDropdown"),H=d("BaseText"),O=d("BaseFormatMoney"),J=d("router-link"),K=d("BasePage");return i(),y($,null,[s(ue),s(K,{class:"xl:pl-96"},{default:n(()=>[s(R,{title:e(C)},{actions:n(()=>[e(N).hasAbilities(e(ce).SEND_PAYMENT)?(i(),B(I,{key:0,disabled:e(M),"content-loading":e(v),variant:"primary",onClick:Y},{default:n(()=>[se(f(a.$t("payments.send_payment_receipt")),1)]),_:1},8,["disabled","content-loading"])):_("",!0),s(pe,{"content-loading":e(v),class:"ml-3",row:e(p)},null,8,["content-loading","row"])]),_:1},8,["title"]),r("div",fe,[r("div",_e,[s(G,{modelValue:e(t).searchText,"onUpdate:modelValue":l[0]||(l[0]=o=>e(t).searchText=o),placeholder:a.$t("general.search"),type:"text",onInput:m},{default:n(()=>[s(x,{name:"SearchIcon",class:"h-5"})]),_:1},8,["modelValue","placeholder"]),r("div",he,[s(q,{position:"bottom-start","width-class":"w-50","position-class":"left-0"},{activator:n(()=>[s(I,{variant:"gray"},{default:n(()=>[s(x,{name:"FilterIcon"})]),_:1})]),default:n(()=>[r("div",be,f(a.$t("general.sort_by")),1),r("div",ge,[s(V,{class:"pt-3 rounded-md hover:rounded-md"},{default:n(()=>[s(S,{class:"-mt-3 font-normal"},{default:n(()=>[s(F,{id:"filter_invoice_number",modelValue:e(t).orderByField,"onUpdate:modelValue":[l[1]||(l[1]=o=>e(t).orderByField=o),m],label:a.$t("invoices.title"),size:"sm",name:"filter",value:"invoice_number"},null,8,["modelValue","label"])]),_:1})]),_:1})]),r("div",Be,[s(V,{class:"pt-3 rounded-md hover:rounded-md"},{default:n(()=>[s(S,{class:"-mt-3 font-normal"},{default:n(()=>[s(F,{modelValue:e(t).orderByField,"onUpdate:modelValue":[l[2]||(l[2]=o=>e(t).orderByField=o),m],label:a.$t("payments.date"),size:"sm",name:"filter",value:"payment_date"},null,8,["modelValue","label"])]),_:1})]),_:1})]),r("div",ve,[s(V,{class:"pt-3 rounded-md hover:rounded-md"},{default:n(()=>[s(S,{class:"-mt-3 font-normal"},{default:n(()=>[s(F,{id:"filter_payment_number",modelValue:e(t).orderByField,"onUpdate:modelValue":[l[3]||(l[3]=o=>e(t).orderByField=o),m],label:a.$t("payments.payment_number"),size:"sm",name:"filter",value:"payment_number"},null,8,["modelValue","label"])]),_:1})]),_:1})])]),_:1}),s(I,{class:"ml-1",size:"md",variant:"gray",onClick:E},{default:n(()=>[e(P)?(i(),B(x,{key:0,name:"SortAscendingIcon"})):(i(),B(x,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),e(c)&&e(c).payments?(i(),y("div",xe,[(i(!0),y($,null,oe(e(c).payments,(o,Q)=>(i(),y("div",{key:Q},[o&&!e(b)?(i(),B(J,{key:0,id:"payment-"+o.id,to:`/admin/payments/${o.id}/view`,class:ne(["flex justify-between p-4 items-center cursor-pointer hover:bg-gray-100 border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":L(o.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:n(()=>[r("div",we,[s(H,{text:o?.customer?.name,length:30,class:"pr-2 mb-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),r("div",ke,f(o?.payment_number),1),r("div",Ie,f(o?.invoice_number),1)]),r("div",Fe,[s(O,{class:"block mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900",amount:o?.amount,currency:o.customer?.currency},null,8,["amount","currency"]),r("div",Se,f(o.formatted_payment_date),1)])]),_:2},1032,["id","to","class"])):_("",!0)]))),128)),r("div",Ve,[e(b)?(i(),B(ye,{key:0,class:"h-6 m-1 animate-spin text-primary-400"})):_("",!0)]),!e(c)?.payments?.length&&!e(b)?(i(),y("p",Pe,f(a.$t("payments.no_matching_payments")),1)):_("",!0)])):_("",!0)]),r("div",je,[e(j)?(i(),y("iframe",{key:0,src:e(j),class:"flex-1 border border-gray-400 border-solid rounded-md"},null,8,Te)):_("",!0)])]),_:1})],64)}}};export{Ue as default};
