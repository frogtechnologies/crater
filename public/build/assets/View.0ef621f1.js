import{J as V,B as y,G as A,aN as C,a0 as W,k as E,A as X,r,o as c,e as h,h as f,f as n,w as o,u as e,t as b,l as p,F as O,y as K,i as k,m as Q,j as I,ah as Y,V as Z,C as ee}from"./vendor.8669b7df.js";import{c as te,t as D,u as ne,e as T,j as M,g as x}from"./main.8525167c.js";import{L as ae}from"./LoadingIcon.5e488a35.js";import{_ as oe}from"./InvoiceIndexDropdown.373050b9.js";import{_ as re}from"./RecurringInvoiceIndexDropdown.67f26955.js";const se={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 ml-56 bg-white xl:ml-64 w-88 xl:block"},ie={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},le={class:"mb-6"},ce={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},ue={class:"px-2 py-1 pb-2 mb-1 mb-2 text-sm border-b border-gray-200 border-solid"},de={key:0,class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid base-scroll"},me={class:"flex-2"},_e={class:"mt-1 mb-2 text-xs not-italic font-medium leading-5 text-gray-600"},ge={class:"flex-1 whitespace-nowrap right"},ve={class:"text-sm not-italic font-normal leading-5 text-right text-gray-600 est-date"},pe={class:"flex justify-center p-4 items-center"},fe={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},ye={setup($){te();const a=D();ne(),T(),M(),V(),y(null),y(null),y(null);const m=A();C(),y(["DRAFT","SENT","VIEWED","EXPIRED","ACCEPTED","REJECTED"]);const s=y(!1),_=y(!1),t=W({orderBy:null,orderByField:null,searchText:null}),w=E(()=>t.orderBy==="asc"||t.orderBy==null);function B(i){return m.params.id==i}async function g(){_.value=!0,await a.fetchRecurringInvoices(),_.value=!1,setTimeout(()=>{R()},500)}function R(){const i=document.getElementById(`recurring-invoice-${m.params.id}`);i&&(i.scrollIntoView({behavior:"smooth"}),i.classList.add("shake"))}async function v(){let i="";t.searchText!==""&&t.searchText!==null&&t.searchText!==void 0&&(i+=`search=${t.searchText}&`),t.orderBy!==null&&t.orderBy!==void 0&&(i+=`orderBy=${t.orderBy}&`),t.orderByField!==null&&t.orderByField!==void 0&&(i+=`orderByField=${t.orderByField}`),s.value=!0;let d=await a.searchRecurringInvoice(i);s.value=!1,d.data&&(a.recurringInvoices=d.data.data)}function S(){return t.orderBy==="asc"?(t.orderBy="desc",v(),!0):(t.orderBy="asc",v(),!0)}return g(),v=X.exports.debounce(v,500),(i,d)=>{const u=r("BaseIcon"),U=r("BaseInput"),F=r("BaseButton"),N=r("BaseRadio"),L=r("BaseInputGroup"),j=r("BaseDropdownItem"),z=r("BaseDropdown"),P=r("BaseText"),G=r("BaseRecurringInvoiceStatusBadge"),H=r("BaseFormatMoney"),q=r("router-link");return c(),h("div",se,[f("div",ie,[f("div",le,[n(U,{modelValue:e(t).searchText,"onUpdate:modelValue":d[0]||(d[0]=l=>e(t).searchText=l),placeholder:i.$t("general.search"),type:"text",variant:"gray",onInput:d[1]||(d[1]=l=>v())},{right:o(()=>[n(u,{name:"SearchIcon",class:"h-5 text-gray-400"})]),_:1},8,["modelValue","placeholder"])]),f("div",ce,[n(z,{class:"ml-3",position:"bottom-start"},{activator:o(()=>[n(F,{size:"md",variant:"gray"},{default:o(()=>[n(u,{name:"FilterIcon",class:"h-5"})]),_:1})]),default:o(()=>[f("div",ue,b(i.$t("general.sort_by")),1),n(j,{class:"flex px-1 py-2 cursor-pointer"},{default:o(()=>[n(L,{class:"-mt-3 font-normal"},{default:o(()=>[n(N,{id:"filter_next_invoice_date",modelValue:e(t).orderByField,"onUpdate:modelValue":[d[2]||(d[2]=l=>e(t).orderByField=l),v],label:i.$t("recurring_invoices.next_invoice_date"),size:"sm",name:"filter",value:"next_invoice_at"},null,8,["modelValue","label"])]),_:1})]),_:1}),n(j,{class:"flex px-1 py-2 cursor-pointer"},{default:o(()=>[n(L,{class:"-mt-3 font-normal"},{default:o(()=>[n(N,{id:"filter_start_date",modelValue:e(t).orderByField,"onUpdate:modelValue":[d[3]||(d[3]=l=>e(t).orderByField=l),v],label:i.$t("recurring_invoices.starts_at"),value:"starts_at",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),n(F,{class:"ml-1",size:"md",variant:"gray",onClick:S},{default:o(()=>[e(w)?(c(),p(u,{key:0,name:"SortAscendingIcon",class:"h-5"})):(c(),p(u,{key:1,name:"SortDescendingIcon",class:"h-5"}))]),_:1})])]),e(a)&&e(a).recurringInvoices?(c(),h("div",de,[(c(!0),h(O,null,K(e(a).recurringInvoices,(l,J)=>(c(),h("div",{key:J},[l&&!_.value?(c(),p(q,{key:0,id:"recurring-invoice-"+l.id,to:`/admin/recurring-invoices/${l.id}/view`,class:Q(["flex justify-between side-invoice p-4 cursor-pointer hover:bg-gray-100 items-center border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":B(l.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:o(()=>[f("div",me,[n(P,{text:l.customer.name,length:30,class:"pr-2 mb-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),f("div",_e,b(l.invoice_number),1),n(G,{status:l.status,class:"px-1 text-xs"},{default:o(()=>[k(b(l.status),1)]),_:2},1032,["status"])]),f("div",ge,[n(H,{class:"block mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900",amount:l.total,currency:l.customer.currency},null,8,["amount","currency"]),f("div",ve,b(l.formatted_starts_at),1)])]),_:2},1032,["id","to","class"])):I("",!0)]))),128)),f("div",pe,[_.value?(c(),p(ae,{key:0,class:"h-6 m-1 animate-spin text-primary-400"})):I("",!0)]),!e(a).recurringInvoices.length&&!_.value?(c(),h("p",fe,b(i.$t("invoices.no_matching_invoices")),1)):I("",!0)])):I("",!0)])}}},be={class:"relative table-container"},Ie={setup($){const a=D(),m=y(null);y(null),Y("$utils");const{t:s}=V();y(null),C();const _=T(),t=E(()=>[{key:"invoice_date",label:s("invoices.date"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"invoice_number",label:s("invoices.invoice")},{key:"customer.name",label:s("invoices.customer")},{key:"status",label:s("invoices.status")},{key:"total",label:s("invoices.total")},{key:"actions",label:s("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);function w(){return _.hasAbilities([x.DELETE_INVOICE,x.EDIT_INVOICE,x.VIEW_INVOICE,x.SEND_INVOICE])}return(B,g)=>{const R=r("SendInvoiceModal"),v=r("router-link"),S=r("BaseFormatMoney"),i=r("BaseInvoiceStatusBadge"),d=r("BaseTable");return c(),h(O,null,[n(R),f("div",be,[n(d,{ref_key:"table",ref:m,data:e(a).newRecurringInvoice.invoices,columns:e(t),loading:e(a).isFetchingViewData,"placeholder-count":5,class:"mt-5"},Z({"cell-invoice_number":o(({row:u})=>[n(v,{to:{path:`/admin/invoices/${u.data.id}/view`},class:"font-medium text-primary-500"},{default:o(()=>[k(b(u.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-total":o(({row:u})=>[n(S,{amount:u.data.due_amount,currency:u.data.currency},null,8,["amount","currency"])]),"cell-status":o(({row:u})=>[n(i,{status:u.data.status,class:"px-3 py-1"},{default:o(()=>[k(b(u.data.status),1)]),_:2},1032,["status"])]),_:2},[w()?{name:"cell-actions",fn:o(({row:u})=>[n(oe,{row:u.data,table:m.value},null,8,["row","table"])])}:void 0]),1032,["data","columns","loading"])])],64)}}},Be={setup($){const a=D(),m=A();let s=E(()=>a.isFetchingViewData);ee(m,()=>{m.params.id&&m.name==="recurring-invoices.view"&&_()},{immediate:!0});async function _(){await a.fetchRecurringInvoice(m.params.id)}return(t,w)=>{const B=r("BaseHeading"),g=r("BaseDescriptionListItem"),R=r("BaseDescriptionList"),v=r("BaseCard");return c(),p(v,{class:"mt-10"},{default:o(()=>[n(B,null,{default:o(()=>[k(b(t.$t("customers.basic_info")),1)]),_:1}),n(R,{class:"mt-5"},{default:o(()=>[n(g,{label:t.$t("recurring_invoices.starts_at"),"content-loading":e(s),value:e(a).newRecurringInvoice?.formatted_starts_at},null,8,["label","content-loading","value"]),n(g,{label:t.$t("recurring_invoices.next_invoice_date"),"content-loading":e(s),value:e(a).newRecurringInvoice?.formatted_next_invoice_at},null,8,["label","content-loading","value"]),e(a).newRecurringInvoice?.limit_date&&e(a).newRecurringInvoice?.limit_by!=="NONE"?(c(),p(g,{key:0,label:t.$t("recurring_invoices.limit_date"),"content-loading":e(s),value:e(a).newRecurringInvoice?.limit_date},null,8,["label","content-loading","value"])):I("",!0),e(a).newRecurringInvoice?.limit_date&&e(a).newRecurringInvoice?.limit_by!=="NONE"?(c(),p(g,{key:1,label:t.$t("recurring_invoices.limit_by"),"content-loading":e(s),value:e(a).newRecurringInvoice?.limit_by},null,8,["label","content-loading","value"])):I("",!0),e(a).newRecurringInvoice?.limit_count?(c(),p(g,{key:2,label:t.$t("recurring_invoices.limit_count"),value:e(a).newRecurringInvoice?.limit_count,"content-loading":e(s)},null,8,["label","value","content-loading"])):I("",!0),e(a).newRecurringInvoice?.selectedFrequency?(c(),p(g,{key:3,label:t.$t("recurring_invoices.frequency.title"),value:e(a).newRecurringInvoice?.selectedFrequency?.label,"content-loading":e(s)},null,8,["label","value","content-loading"])):I("",!0)]),_:1}),n(B,{class:"mt-8"},{default:o(()=>[k(b(t.$t("invoices.title",2)),1)]),_:1}),n(Ie)]),_:1})}}},Ee={setup($){M();const a=D(),m=T();V(),C();const s=E(()=>a.newRecurringInvoice?a.newRecurringInvoice?.customer?.name:"");function _(){return m.hasAbilities([x.DELETE_RECURRING_INVOICE,x.EDIT_RECURRING_INVOICE])}return(t,w)=>{const B=r("BasePageHeader"),g=r("BasePage");return c(),p(g,{class:"xl:pl-96"},{default:o(()=>[n(B,{title:e(s)},{actions:o(()=>[_()?(c(),p(re,{key:0,row:e(a).newRecurringInvoice},null,8,["row"])):I("",!0)]),_:1},8,["title"]),n(ye),n(Be)]),_:1})}}};export{Ee as default};
